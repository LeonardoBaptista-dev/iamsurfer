{% extends "base.html" %}

{% block title %}Reportar Condi√ß√µes - {{ spot.name }} - IAmSurfer{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">üìã Reportar Condi√ß√µes do Spot</h4>
                    <small class="text-muted">{{ spot.name }} - {{ spot.city }}, {{ spot.state }}</small>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <div class="row">
                            <!-- Condi√ß√µes Gerais -->
                            <div class="col-md-6">
                                <h6 class="text-primary mb-3">üåä Condi√ß√µes das Ondas</h6>
                                
                                <div class="mb-3">
                                    <label for="conditions" class="form-label">Condi√ß√µes Gerais *</label>
                                    <select class="form-control" id="conditions" name="conditions" required>
                                        <option value="">Selecione</option>
                                        <option value="flat">Flat (sem ondas)</option>
                                        <option value="poor">Ruim</option>
                                        <option value="fair">Regular</option>
                                        <option value="good">Bom</option>
                                        <option value="epic">√âpico</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="wave_height" class="form-label">Altura das Ondas (metros)</label>
                                    <input type="number" step="0.1" class="form-control" id="wave_height" name="wave_height" placeholder="Ex: 1.5">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="crowd_level" class="form-label">N√≠vel de Multid√£o</label>
                                    <select class="form-control" id="crowd_level" name="crowd_level">
                                        <option value="">Selecione</option>
                                        <option value="vazio">Vazio</option>
                                        <option value="baixo">Baixo</option>
                                        <option value="m√©dio">M√©dio</option>
                                        <option value="alto">Alto</option>
                                        <option value="lotado">Lotado</option>
                                    </select>
                                </div>
                            </div>
                            
            
                            <!-- Condi√ß√µes do Vento -->
                            <div class="col-md-6">
                                <h6 class="text-primary mb-3">üí® Condi√ß√µes do Vento</h6>
                                
                                <div class="mb-3">
                                    <label for="wind_direction" class="form-label">Dire√ß√£o do Vento</label>
                                    <select class="form-control" id="wind_direction" name="wind_direction">
                                        <option value="">Selecione</option>
                                        <option value="N">Norte</option>
                                        <option value="NE">Nordeste</option>
                                        <option value="E">Leste</option>
                                        <option value="SE">Sudeste</option>
                                        <option value="S">Sul</option>
                                        <option value="SW">Sudoeste</option>
                                        <option value="W">Oeste</option>
                                        <option value="NW">Noroeste</option>
                                        <option value="calmo">Calmo</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="wind_speed" class="form-label">Velocidade do Vento (km/h)</label>
                                    <input type="number" step="1" class="form-control" id="wind_speed" name="wind_speed" placeholder="Ex: 15">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="water_temp" class="form-label">Temperatura da √Ågua (¬∞C)</label>
                                    <input type="number" step="0.1" class="form-control" id="water_temp" name="water_temp" placeholder="Ex: 22.5">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Observa√ß√µes -->
                        <div class="mb-3">
                            <label for="notes" class="form-label">Observa√ß√µes Adicionais</label>
                            <textarea class="form-control" id="notes" name="notes" rows="4" placeholder="Descreva outros detalhes sobre as condi√ß√µes, acesso, perigos, etc."></textarea>
                        </div>
                        
                        <!-- Preview das Condi√ß√µes -->
                        <div class="alert alert-light border" id="conditionsPreview" style="display: none;">
                            <h6>üìã Preview do seu relat√≥rio:</h6>
                            <div id="previewContent"></div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Enviar Relat√≥rio
                            </button>
                            <a href="{{ url_for('spots.new_spot_detail', spot_id=spot.id) }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Voltar
                            </a>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Dicas -->
            <div class="card mt-3">
                <div class="card-body">
                    <h6>üí° Dicas para um bom relat√≥rio:</h6>
                    <ul class="small text-muted mb-0">
                        <li>Seja espec√≠fico sobre as condi√ß√µes atuais</li>
                        <li>Mencione qualquer mudan√ßa nas condi√ß√µes durante o dia</li>
                        <li>Inclua informa√ß√µes sobre acesso ou perigos</li>
                        <li>Considere mencionar o hor√°rio da sua observa√ß√£o</li>
                        <li>Seja respeitoso com outros surfistas e o local</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Fun√ß√£o para atualizar o preview
    function updatePreview() {
        const conditions = document.getElementById('conditions').value;
        const waveHeight = document.getElementById('wave_height').value;
        const windDirection = document.getElementById('wind_direction').value;
        const windSpeed = document.getElementById('wind_speed').value;
        const crowdLevel = document.getElementById('crowd_level').value;
        const waterTemp = document.getElementById('water_temp').value;
        const notes = document.getElementById('notes').value;
        
        if (!conditions) {
            document.getElementById('conditionsPreview').style.display = 'none';
            return;
        }
        
        let preview = `<strong>Condi√ß√µes:</strong> ${conditions.charAt(0).toUpperCase() + conditions.slice(1)}`;
        
        if (waveHeight) {
            preview += `<br><strong>Altura das Ondas:</strong> ${waveHeight}m`;
        }
        
        if (windDirection && windSpeed) {
            preview += `<br><strong>Vento:</strong> ${windDirection} ${windSpeed}km/h`;
        } else if (windDirection) {
            preview += `<br><strong>Vento:</strong> ${windDirection}`;
        }
        
        if (crowdLevel) {
            preview += `<br><strong>Multid√£o:</strong> ${crowdLevel.charAt(0).toUpperCase() + crowdLevel.slice(1)}`;
        }
        
        if (waterTemp) {
            preview += `<br><strong>Temperatura da √Ågua:</strong> ${waterTemp}¬∞C`;
        }
        
        if (notes) {
            preview += `<br><strong>Observa√ß√µes:</strong> ${notes}`;
        }
        
        document.getElementById('previewContent').innerHTML = preview;
        document.getElementById('conditionsPreview').style.display = 'block';
    }
    
    // Adicionar listeners para atualizar o preview
    const inputs = ['conditions', 'wave_height', 'wind_direction', 'wind_speed', 'crowd_level', 'water_temp', 'notes'];
    inputs.forEach(inputId => {
        const element = document.getElementById(inputId);
        if (element) {
            element.addEventListener('input', updatePreview);
            element.addEventListener('change', updatePreview);
        }
    });
    
    // Valida√ß√£o do formul√°rio
    document.querySelector('form').addEventListener('submit', function(e) {
        const conditions = document.getElementById('conditions').value;
        
        if (!conditions) {
            e.preventDefault();
            alert('Por favor, selecione as condi√ß√µes gerais do spot.');
            document.getElementById('conditions').focus();
        }
    });
</script>
{% endblock %}
